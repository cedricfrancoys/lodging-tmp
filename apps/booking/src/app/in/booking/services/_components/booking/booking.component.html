<div class="overlay-container" *ngIf="loading"><mat-spinner></mat-spinner></div>
<div class="container">
    <div class="outer-wrapper" style="width: 100%">
        <div class="header">
            <div *ngIf="cancreateGroup()" style="flex: 1;">Ajouter un groupe de services <button mat-mini-fab color="primary" style="transform: scale(0.66);" (click)="oncreateGroup()"> <mat-icon>add</mat-icon></button></div>
            <div style="margin-left: auto; font-size: 20px;">Total TTC {{instance.price | number: '1.2-2'}} â‚¬</div>
        </div>
        <div class="inner-wrapper" *ngIf="instance.booking_lines_groups_ids.length">
            <div class="groups-list" cdkDropList (cdkDropListDropped)="ondropGroup($event)">
                <!-- groups -->
                <ng-container *ngFor="let group of instance.booking_lines_groups_ids;">
                    <div class="group-item"
                        cdkDrag
                        [cdkDragData]="group"
                        [cdkDragDisabled]="maximized_group_id == group.id"
                        [class.group-selected]="maximized_group_id == group.id"
                        [class.group-extra]="group.is_extra"
                        [class.group-autosale]="group.is_autosale"
                        [class.hidden]="maximized_group_id != 0 && maximized_group_id != group.id"
                        [@groupInOutAnimation]>
                        <div class="group-handle" cdkDragHandle *ngIf="maximized_group_id == 0"><mat-icon style="font-size: 16px;">drag_indicator</mat-icon></div>
                        <booking-services-booking-group
                            [model]="group"
                            [booking]="instance"
                            (updated)="onupdateGroup()"
                            (deleted)="ondeleteGroup(group.id)"
                            (toggle)="ontoggleGroup(group.id, $event)"
                            (loadStart)="onLoadStartGroup()"
                            (loadEnd)="onLoadEndGroup()"
                        ></booking-services-booking-group>
                        <div class="group-remove" *ngIf="maximized_group_id == 0"><button mat-icon-button (click)="ondeleteGroup(group.id)"> <mat-icon>delete</mat-icon></button></div>
                    </div>
                </ng-container>
            </div>
        </div>
    </div>
</div>